<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('Transactions')"></head>
<body>
<div class="app">
  <aside th:replace="fragments/sidebar :: sidebar(${active})"></aside>
  <main class="content">
    <div class="topbar">
      <div class="title">Transactions</div>
      <a class="btn secondary" th:href="@{/dashboard}"><i class="ri-arrow-left-line"></i> Back</a>
    </div>

    <div class="grid cols-2">
      <div class="card">
        <div class="card-title">Add New</div>
        <form class="form" th:action="@{/transactions}" method="post">
          <div class="form-row">
            <input type="date" name="date" required/>
            <input type="text" name="merchant" placeholder="Merchant / Description" required/>
            <input type="number" step="0.01" name="amount" placeholder="Amount" required/>
            <select name="categoryId" required>
              <option th:each="c: ${categories}" th:value="${c.id}" th:text="${c.name}">Food</option>
            </select>
          </div>
          <div class="form-row">
            <select name="accountId" required>
              <option th:each="a: ${accounts}" th:value="${a.id}" th:text="${a.name}">Wallet</option>
            </select>
            <input type="text" name="note" placeholder="Note (optional)"/>
          </div>
          <div>
            <button class="btn" type="submit"><i class="ri-add-line"></i> Add transaction</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="card-title">Transactions</div>
        <table class="table">
          <thead><tr><th>Date</th><th>Merchant</th><th>Category</th><th>Account</th><th>Amount</th></tr></thead>
          <tbody>
            <tr th:each="t: ${transactions}">
              <td th:text="${t.date}">2024-10-01</td>
              <td th:text="${t.merchant}">Merchant</td>
              <td th:text="${t.category != null ? t.category.name : 'Uncategorized'}">Food</td>
              <td th:text="${t.account.name}">Wallet</td>
              <td class="amount" th:classappend="${t.category.type.name()=='EXPENSE'}? ' expense' : ' income'"
                  th:text="${#numbers.formatDecimal(t.amount,1,'COMMA',2,'POINT')}">$0.00</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </main>
</div>
<div th:replace="fragments/scripts :: scripts"></div>
</body>
</html>
